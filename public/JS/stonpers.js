(()=>{"use strict";const t=function(){function t(){}return t.rectangleCollision=function(t,r){return t.x<r.x+r.width&&t.x+t.width>r.x&&t.y<r.y+r.height&&t.y+t.height>r.y},t.circleCollision=function(t,r){return Math.sqrt(Math.pow(r.x-t.x,2)+Math.pow(r.y-t.y,2))<t.radius+r.radius},t.onCollision=function(t,r){for(var o=0;o<g.gameObjects.length;o++)if(g.gameObjects[o].tag==t)return{objeto:g.gameObjects[o],colidiu:this.rectangleCollision(g.gameObjects[o],r)};return null},t}(),r=function(){function t(){}return t.width=1,t.height=1,t.clicou=!1,t}(),o=function(){function t(t){this.tag="",this.x=0,this.y=0,this.width=0,this.height=0,t&&(this.tag=t)}return t.prototype.hasCode=function(){return Reflect.getPrototypeOf(this).constructor.name},t.prototype.colidir=function(){},t.prototype.desenhar=function(){},t.prototype.update=function(){},t}();var i,n=(i=function(t,r){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},i(t,r)},function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=t}i(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)});const e=function(o){function i(t,r,i,n,e,a,c){var s=o.call(this)||this;return s.imagem=null,s.virada=!1,s.width=i,s.height=n,s.x=t,s.y=r,s.valor=e,s.naipe=a,c&&(s.imagem=c),s}return n(i,o),i.prototype.desenhar=function(){if(this.imagem)if(this.imagem.desenhar(this.x,this.y,this.width,this.height),this.virada)this.imagem.x=141,this.imagem.y=410;else{var t=i.cardsCut.get(this.valor.toString()+this.naipe);this.imagem.x=t.x,this.imagem.y=t.y}},i.prototype.colidir=function(){return t.rectangleCollision(this,{x:r.x,y:r.y,width:1,height:1})&&r.clicou?(console.log(this.valor+this.naipe),{carta:this,colidiu:!0}):{colidiu:!1}},i.prototype.virar=function(){this.virada=!this.virada},i.naipes=["PAUS","OUROS","COPAS","ESPADAS"],i.cardsCut=new Map,i}(o),a=function(){function t(t,r){this.width=t.width,this.height=t.height,this.x=t.x,this.y=t.y,this.image=new Image,this.image.src=r}return t.prototype.desenhar=function(t,r,o,i){g.ctx.drawImage(this.image,this.x,this.y,this.width,this.height,t,r,o,i)},t}();var c=function(){var t=function(r,o){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},t(r,o)};return function(r,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function i(){this.constructor=r}t(r,o),r.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}();const s=function(t){function r(r){var o=t.call(this,r)||this;return o.cartas=[],o}return c(r,t),r.prototype.create=function(){for(var t=0;t<4;t++)for(var o=0;o<13;o++){var i=o+1,n=e.cardsCut.get(i.toString()+e.naipes[t]),c=new a(n,"./public/image/do_meu_avo.png"),s=new e(8*o,0,r.widthC,r.heightC,i,e.naipes[t],c);this.cartas.push(s)}},r.prototype.desenhar=function(){this.cartas.forEach((function(t){t.desenhar()}))},r.prototype.update=function(){this.colidir()},r.prototype.colidir=function(){if(this.cartas.length>0)return this.cartas[this.cartas.length-1].colidir().colidiu},r.prototype.retirar=function(){return this.cartas.pop()},r.prototype.embaralhar=function(){for(var t=this.cartas.length-1;t>0;t--){var r=Math.floor(Math.random()*(t+1)),o=this.cartas[t],i={x:this.cartas[t].x,y:this.cartas[t].y};this.cartas[t].x=this.cartas[r].x,this.cartas[t].y=this.cartas[r].y,this.cartas[t]=this.cartas[r],this.cartas[r].x=i.x,this.cartas[r].y=i.y,this.cartas[r]=o}},r.prototype.distribuir=function(t){for(var r=0;r<4;r++)t.mao.cartas.push(this.cartas[this.cartas.length-1]),this.cartas.pop()},r.prototype.colocar=function(t){t.x=g.WIDTH/2,t.y=g.HEIGHT/8,this.cartas.push(t)},r.prototype.getUltima=function(){return this.cartas[this.cartas.length-1]},r.widthC=70,r.heightC=100,r.cartaNula=new e(0,0,0,0,-1,"NULO"),r}(o);var h=function(){var t=function(r,o){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},t(r,o)};return function(r,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function i(){this.constructor=r}t(r,o),r.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}();const u=function(t){function r(){var r=null!==t&&t.apply(this,arguments)||this;return r.cartas=[],r}return h(r,t),r.prototype.desenhar=function(){this.cartas.forEach((function(t){t.desenhar()}))},r.prototype.colidir=function(){for(var t=0;t<this.cartas.length;t++){var r=this.cartas[t].colidir();if(r.colidiu)return{carta:r.carta,index:t}}return null},r.prototype.trocar=function(t,r){t.x=this.cartas[r].x,t.y=this.cartas[r].y,this.cartas[r]=t},r.prototype.cortar=function(t,r){r.colocar(this.cartas[t]),this.cartas[t]=s.cartaNula},r.prototype.colocar=function(t){},r.prototype.posicionar=function(t){},r.prototype.retirar=function(t){this.cartas[t]=s.cartaNula},r}(o);var p=function(){var t=function(r,o){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},t(r,o)};return function(r,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function i(){this.constructor=r}t(r,o),r.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}();const l=function(t){function o(r,o,i,n){var e=t.call(this,r)||this;return e.comprada=null,e.comprou=!1,e.posx=o,e.posy=i,e.mao=n,e.width=1,e.height=1,e}return p(o,t),o.prototype.arrumarCartas=function(){for(var t=0;t<this.mao.cartas.length;t++)this.mao.cartas[t].y=t%2==0?this.posy-s.heightC:this.posy,this.mao.cartas[t].x=this.posx-s.widthC+s.widthC*Math.floor(t/2)},o.prototype.desenhar=function(){var t;this.mao.desenhar(),this.comprada&&(null===(t=this.comprada)||void 0===t||t.desenhar())},o.prototype.update=function(){if(this.x=r.x,this.y=r.y,this.comprou){g.getInterfaceByTag("descartar").visivel=!0;var t=g.getInterfaceByTag("descartar");t.colidir()&&(console.log(t.colidir()),this.descartar())}else g.getInterfaceByTag("descartar").visivel=!1,this.comprar(),this.cortar;this.colidir()},o.prototype.colidir=function(){var t=this.mao.colidir();if(t)if(this.comprou){var r=g.getObjectByTag("descarte");this.trocar(r,t)}else this.cortar(t)},o.prototype.comprar=function(){var t=g.getObjectByTag("monte"),r=g.getObjectByTag("descarte");t.colidir()&&(console.log(t),this.comprada=t.retirar(),this.comprada.x=.6*this.posx,this.comprada.y=this.posy,this.comprou=!0),r.colidir()&&(console.log(r),this.comprada=r.retirar(),this.comprada.x=.6*this.posx,this.comprada.y=this.posy,this.comprou=!0)},o.prototype.trocar=function(t,r){this.comprada&&(this.mao.trocar(this.comprada,r.index),t.colocar(r.carta),this.comprou=!1,this.comprada=null)},o.prototype.descartar=function(){g.getObjectByTag("descarte").colocar(this.comprada),this.comprada=null,this.comprou=!1},o.prototype.cortar=function(t){var r=this,o=g.getObjectByTag("descarte"),i=o.getUltima();i&&(t.carta.x=i.x,t.carta.y=i.y,setTimeout((function(){i.valor==t.carta.valor?(r.mao.retirar(t.index),o.colocar(t.carta)):(console.log("Corte errado"),t.carta.x=0,t.carta.y=200)}),1e3))},o.prototype.penalidade=function(t){},o}(o),f=function(){function t(t,r,o,i,n){this.visivel=!0,this.x=0,this.y=0,this.width=0,this.height=0,this.tag=t,this.x=r,this.y=o,this.width=i,this.height=n}return t.prototype.desenhar=function(){this.visivel&&(g.ctx.fillStyle="#F00",g.ctx.fillRect(this.x,this.y,this.width,this.height))},t.prototype.update=function(){},t}();var y=function(){var t=function(r,o){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},t(r,o)};return function(r,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function i(){this.constructor=r}t(r,o),r.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}();const d=function(o){function i(t,r,i,n,e){return o.call(this,t,r,i,n,e)||this}return y(i,o),i.prototype.colidir=function(){return t.rectangleCollision(this,r)&&r.clicou&&console.log("Apertado"),t.rectangleCollision(this,r)&&r.clicou},i.prototype.update=function(){this.colidir()},i}(f),g=function(){function t(){}return t.getObjectByTag=function(r){for(var o=0;o<t.gameObjects.length;o++)if(t.gameObjects[o].tag==r)return t.gameObjects[o]},t.getInterfaceByTag=function(r){for(var o=0;o<t.interfaces.length;o++)if(t.interfaces[o].tag==r)return t.interfaces[o]},t.prototype.update=function(){var o=this;t.gameObjects.forEach((function(t){t.update()})),r.clicou&&(r.clicou=!r.clicou),window.requestAnimationFrame((function(){return o.update()}))},t.prototype.render=function(){var r=this;t.ctx.clearRect(0,0,t.WIDTH,t.HEIGHT),t.ctx.fillStyle="#0FF0CB",t.ctx.fillRect(0,0,t.WIDTH,t.HEIGHT),t.gameObjects.forEach((function(t){t.desenhar()})),t.interfaces.forEach((function(t){t.desenhar()})),window.requestAnimationFrame((function(){return r.render()}))},t.prototype.start=function(){for(var r=0;r<4;r++)for(var o=0;o<13;o++){var i=(o+1).toString()+e.naipes[r];e.cardsCut.set(i,{x:71*o,y:103*r,width:71,height:103})}var n=new s("monte");n.create();var a=new s("descarte"),c=new l("player1",t.WIDTH/2,t.HEIGHT/2,new u);n.embaralhar(),n.distribuir(c),c.arrumarCartas(),t.gameObjects.push(n),t.gameObjects.push(a),t.gameObjects.push(c);var h=new d("descartar",100,400,50,30);t.interfaces.push(h),this.render(),this.update()},t.gameObjects=[],t.interfaces=[],t.WIDTH=window.innerWidth,t.HEIGHT=window.innerHeight,t}();var m=document.getElementById("canvas1");g.ctx=m.getContext("2d"),m.width=window.innerWidth,m.height=window.innerHeight,window.addEventListener("click",(function(t){r.clicou=0==t.button})),window.addEventListener("mousemove",(function(t){r.x=t.clientX,r.y=t.clientY})),(new g).start()})();