(()=>{"use strict";const t=function(){function t(t,r){this.width=t.width,this.height=t.height,this.x=t.x,this.y=t.y,this.image=new Image,this.image.src=r}return t.prototype.desenhar=function(t,r,o,i){f.ctx.drawImage(this.image,this.x,this.y,this.width,this.height,t,r,o,i)},t}(),r=function(){function t(){}return t.rectangleCollision=function(t,r){return t.x<r.x+r.width&&t.x+t.width>r.x&&t.y<r.y+r.height&&t.y+t.height>r.y},t.circleCollision=function(t,r){return Math.sqrt(Math.pow(r.x-t.x,2)+Math.pow(r.y-t.y,2))<t.radius+r.radius},t.onCollision=function(t,r){for(var o=0;o<f.gameObjects.length;o++)if(f.gameObjects[o].tag==t)return{objeto:f.gameObjects[o],colidiu:this.rectangleCollision(f.gameObjects[o],r)};return null},t}(),o=function(){function t(){}return t.clicou=!1,t}(),i=function(){function t(){this.x=0,this.y=0,this.width=0,this.height=0,this.tag=""}return t.prototype.hasCode=function(){return Reflect.getPrototypeOf(this).constructor.name},t.prototype.colidir=function(){},t.prototype.desenhar=function(){},t.prototype.update=function(){},t}();var n,e=(n=function(t,r){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},n(t,r)},function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=t}n(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)});const a=function(t){function i(r,o,i,n,e,a,c){var s=t.call(this)||this;return s.virada=!1,s.width=i,s.height=n,s.x=r,s.y=o,s.valor=e,s.naipe=a,s.imagem=c,s}return e(i,t),i.prototype.desenhar=function(){if(this.imagem.desenhar(this.x,this.y,this.width,this.height),this.virada)this.imagem.x=141,this.imagem.y=410;else{var t=i.cardsCut.get(this.valor.toString()+this.naipe);this.imagem.x=t.x,this.imagem.y=t.y}},i.prototype.colidir=function(){return r.rectangleCollision(this,{x:o.x,y:o.y,width:1,height:1})&&o.clicou?(console.log(this.valor+this.naipe),{carta:this,colidiu:!0}):{colidiu:!1}},i.prototype.virar=function(){this.virada=!this.virada},i.naipes=["PAUS","OUROS","COPAS","ESPADAS"],i.cardsCut=new Map,i}(i);var c=function(){var t=function(r,o){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},t(r,o)};return function(r,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function i(){this.constructor=r}t(r,o),r.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}();const s=function(r){function o(){var t=r.call(this)||this;return t.cartas=[],t}return c(o,r),o.prototype.create=function(){for(var r=0;r<4;r++)for(var i=0;i<13;i++){var n=i+1;13!=n||"OUROS"!=a.naipes[r]&&"COPAS"!=a.naipes[r]||(n=0);var e=a.cardsCut.get(n.toString()+a.naipes[r]),c=new t(e,"./public/image/do_meu_avo.png"),s=new a(8*i,0,o.widthC,o.heightC,n,a.naipes[r],c);this.cartas.push(s)}},o.prototype.desenhar=function(){this.cartas.forEach((function(t){t.desenhar()}))},o.prototype.update=function(){this.colidir()},o.prototype.colidir=function(){return this.cartas[this.cartas.length-1].colidir().colidiu},o.prototype.retirar=function(){var t=this.cartas[this.cartas.length-1];return this.cartas.pop(),t},o.prototype.embaralhar=function(){for(var t=this.cartas.length-1;t>0;t--){var r=Math.floor(Math.random()*(t+1)),o=this.cartas[t],i={x:this.cartas[t].x,y:this.cartas[t].y};this.cartas[t].x=this.cartas[r].x,this.cartas[t].y=this.cartas[r].y,this.cartas[t]=this.cartas[r],this.cartas[r].x=i.x,this.cartas[r].y=i.y,this.cartas[r]=o}},o.prototype.distribuir=function(t){for(var r=0;r<4;r++)t.mao.cartas.push(this.cartas[this.cartas.length-1]),this.cartas.pop()},o.prototype.colocar=function(t){t.x=f.WIDTH/2,t.y=f.HEIGHT/8,this.cartas.push(t)},o.widthC=70,o.heightC=100,o}(i);var h=function(){var t=function(r,o){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},t(r,o)};return function(r,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function i(){this.constructor=r}t(r,o),r.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}();const u=function(t){function r(){var r=null!==t&&t.apply(this,arguments)||this;return r.cartas=[],r}return h(r,t),r.prototype.desenhar=function(){this.cartas.forEach((function(t){t.desenhar()}))},r.prototype.colidir=function(){for(var t=0;t<this.cartas.length;t++){var r=this.cartas[t].colidir();if(r.colidiu)return{carta:r.carta,index:t}}return null},r.prototype.trocar=function(t,r){t.x=this.cartas[r].x,t.y=this.cartas[r].y,this.cartas[r]=t},r}(i);var p=function(){var t=function(r,o){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},t(r,o)};return function(r,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function i(){this.constructor=r}t(r,o),r.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}();const l=function(t){function r(r,o,i){var n=t.call(this)||this;return n.comprada=null,n.posx=r,n.posy=o,n.mao=i,n.width=1,n.height=1,n}return p(r,t),r.prototype.arrumarCartas=function(){for(var t=0;t<this.mao.cartas.length;t++)this.mao.cartas[t].y=t%2==0?this.posy-s.heightC:this.posy,this.mao.cartas[t].x=this.posx-s.widthC+s.widthC*Math.floor(t/2)},r.prototype.desenhar=function(){var t;this.mao.desenhar(),this.comprada&&(null===(t=this.comprada)||void 0===t||t.desenhar())},r.prototype.update=function(){this.x=o.x,this.y=o.y,this.comprar2(),this.descartar(),this.colidir()},r.prototype.colidir=function(){var t=this.mao.colidir();t&&this.trocar(t.index)},r.prototype.comprar=function(t){this.comprada=t,console.log(this.comprada),this.comprada.x=.6*this.posx,this.comprada.y=this.posy},r.prototype.comprar2=function(){for(var t=0;t<f.gameObjects.length;t++)console.log(f.gameObjects[t].tag),"monte"===f.gameObjects[t].tag&&f.gameObjects[t].colidir()&&(this.comprada=f.gameObjects[t].retirar(),this.comprada.x=.6*this.posx,this.comprada.y=this.posy)},r.prototype.trocar=function(t){this.comprada&&this.mao.trocar(this.comprada,t)},r.prototype.descartar=function(){for(var t=0;t<f.gameObjects.length;t++)console.log(f.gameObjects[t].tag),"descarte"===f.gameObjects[t].tag&&f.gameObjects[t].colidir()&&(this.comprada=f.gameObjects[t].colocar(this.comprada),this.comprada=null)},r}(i),f=function(){function r(){}return r.prototype.update=function(){var t=this;r.gameObjects.forEach((function(t){t.update()})),o.clicou&&(o.clicou=!o.clicou),window.requestAnimationFrame((function(){return t.update()}))},r.prototype.render=function(){var t=this;r.ctx.clearRect(0,0,r.WIDTH,r.HEIGHT),r.ctx.fillStyle="#0FF0CB",r.ctx.fillRect(0,0,r.WIDTH,r.HEIGHT),r.gameObjects.forEach((function(t){t.desenhar()})),window.requestAnimationFrame((function(){return t.render()}))},r.prototype.start=function(){for(var o=0;o<4;o++)for(var i=0;i<13;i++){var n=i+1;13!=n||"OUROS"!=a.naipes[o]&&"COPAS"!=a.naipes[o]||(n=0);var e=n.toString()+a.naipes[o];a.cardsCut.set(e,{x:71*i,y:103*o,width:71,height:103})}var c=new s;c.create();var h=new s;c.tag="monte",h.tag="descarte";var p=a.cardsCut.get("0"+a.naipes[1]),f=new t(p,"./public/image/do_meu_avo.png"),d=new a(r.WIDTH/2,r.HEIGHT/8,s.widthC,s.heightC,0,a.naipes[1],f);h.cartas.push(d);var y=new l(r.WIDTH/2,r.HEIGHT/2,new u);c.embaralhar(),console.log(c),c.distribuir(y),y.arrumarCartas(),y.tag="player1",r.gameObjects.push(c),r.gameObjects.push(h),r.gameObjects.push(y),this.render(),this.update()},r.gameObjects=[],r.WIDTH=window.innerWidth,r.HEIGHT=window.innerHeight,r}();var d=document.getElementById("canvas1");f.ctx=d.getContext("2d"),d.width=window.innerWidth,d.height=window.innerHeight,window.addEventListener("click",(function(t){o.clicou=0==t.button})),window.addEventListener("mousemove",(function(t){o.x=t.clientX,o.y=t.clientY})),(new f).start()})();